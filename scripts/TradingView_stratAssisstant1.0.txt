// Â© rickyzcarroll

//@version=4

// Twitter follow if you have any questions @RickyZane85

///////////////////////////////////////////////
// variables
///////////////////////////////////////////////
oneBarColor = color.yellow
oneBarChar = "1"
oneBarString = "1"

twoUpBarColor = color.green
twoUpBarChar = "2"
twoUpBarString = "U"
twoUpBarStyle = shape.triangleup

twoDownBarColor = color.red
twoDownBarChar = "2"
twoDownBarString = "D"
twoDownBarStyle = shape.triangledown

threeBarColor = color.fuchsia
threeBarChar = "3"
threeBarString = "3"

barCharLocation = location.belowbar
barShapeLocation = location.abovebar

stratComboLocation = location.top
stratComboBullColor = color.green
stratComboBearColor = color.red
stratComboStyle = shape.flag

zeroIndexStart = 0
oneIndexStart = 1
twoIndexStart = 2
threeIndexStart = 3


///////////////////////////////////////////////
// functions
///////////////////////////////////////////////
getOneBar(rightBar,leftBar) =>
    high[rightBar] <= high[leftBar] and low[rightBar] >= low[leftBar]


getTwoUpBar(rightBar, leftBar) =>
    high[rightBar] > high[leftBar] and not (low[rightBar] < low[leftBar])

getTwoDownBar(rightBar, leftBar) => 
    low[rightBar] < low[leftBar] and not (high[rightBar] > high[leftBar])

getThreeBar(rightBar, leftBar) => 
    high[rightBar] > high[leftBar] and low[rightBar] < low[leftBar]


getBarColor()  => 
    iff(getOneBar(0, 1), oneBarColor, iff(getThreeBar(0,1), threeBarColor, iff(getTwoUpBar(0,1), twoUpBarColor, iff(getTwoDownBar(0,1), twoDownBarColor, na))))

// reusable functions for each bar
getIndexOneBar(barIndex) => getOneBar(barIndex, (barIndex+1))
getIndexTwoUpBar(barIndex) => getTwoUpBar(barIndex, (barIndex+1))
getIndexTwoDownBar(barIndex) => getTwoDownBar(barIndex, (barIndex+1))
getIndexThreeBar(barIndex) => getThreeBar(barIndex, (barIndex+1))


// strategies... these generally work left to right - the far right bar is index 0, add on to go back each time
is222BearishContinuation = getIndexTwoDownBar(2) and getIndexTwoDownBar(1) and getIndexTwoDownBar(0)
is222BullishContinuation = getIndexTwoUpBar(2) and getIndexTwoUpBar(1) and getIndexTwoUpBar(0)

is212BearishContinuationMeasuredMove = getIndexTwoDownBar(2) and getIndexOneBar(1) and getIndexTwoDownBar(0)
is212BullishContinuationMeasuredMove = getIndexTwoUpBar(2) and getIndexOneBar(1) and getIndexTwoUpBar(0)

is22BearishReversal = getIndexTwoUpBar(1) and getIndexTwoDownBar(0) and not getIndexOneBar(2) and not getIndexTwoDownBar(2) and not getIndexTwoDownBar(3) and not getIndexThreeBar(2)
is22BullishReversal = getIndexTwoDownBar(1) and getIndexTwoUpBar(0) and not getIndexOneBar(2) and not getIndexTwoUpBar(2) and not getIndexTwoUpBar(3) and not getIndexThreeBar(2)

is212BearishReversal = getIndexTwoUpBar(2) and getIndexOneBar(1) and getIndexTwoDownBar(0)
is212BullishReversal = getIndexTwoDownBar(2) and getIndexOneBar(1) and getIndexTwoUpBar(0)

is322BearishReversal = getIndexThreeBar(2) and getIndexTwoUpBar(1) and getIndexTwoDownBar(0)
is322BullishReversal = getIndexThreeBar(2) and getIndexTwoDownBar(1) and getIndexTwoUpBar(0)

is32BearishReversal = getIndexThreeBar(1) and getIndexTwoDownBar(0)
is32BullishReversal = getIndexThreeBar(1) and getIndexTwoUpBar(0)

is312BearishReversal = getIndexThreeBar(2) and getIndexOneBar(1) and getIndexTwoDownBar(0)
is312BullishReversal = getIndexThreeBar(2) and getIndexOneBar(1) and getIndexTwoUpBar(0)

is122BearishRevStratReversal = getIndexOneBar(2) and getIndexTwoUpBar(1) and getIndexTwoDownBar(0)
is122BullishRevStratReversal = getIndexOneBar(2) and getIndexTwoDownBar(1) and getIndexTwoUpBar(0)

is2222BearishRandyJackson = getIndexTwoDownBar(3) and getIndexTwoDownBar(2) and getIndexTwoUpBar(1) and getIndexTwoDownBar(0) 
is2222BullishRandyJackson = getIndexTwoUpBar(3) and getIndexTwoUpBar(2) and getIndexTwoDownBar(1) and getIndexTwoUpBar(0) 

is3BearishRevStratReversal = getIndexThreeBar(0) and close[0] < low[1]
is3BullishRevStratReversal = getIndexThreeBar(0) and close[0] > low[1]

// actionable signal
getCandleHeight = high[0] - low[0]
getActionalbeWickHeight = getCandleHeight*.70
getShooterTop = high[0] - getActionalbeWickHeight
getHammerBottom = low[0] + getActionalbeWickHeight
isInsideBar = getIndexOneBar(0)
isShooter = open[0] < getShooterTop and close[0] < getShooterTop and not getIndexOneBar(0) //inside bar trumps hammer or shooter
isHammer = open[0] > getHammerBottom and close[0] > getHammerBottom and not getIndexOneBar(0) //inside bar trumps hammer or shooter


///////////////////////////////////////////////
// study
///////////////////////////////////////////////
study("Strat Help RZC", overlay=true, precision=0)
    

// identify 1 candle
plotchar(getOneBar(0,1), title="One Bar Label", char=oneBarChar, location=barCharLocation, color=getBarColor())

// identify 2 up candle
plotshape(getTwoUpBar(0,1), style=twoUpBarStyle, title="Two Up Bar Shape", location=barShapeLocation, color=getBarColor())
plotchar(getTwoUpBar(0,1), title="Two Up Bar Char", char=twoUpBarChar, location=barCharLocation, color=getBarColor())

// identify 2 down candle
plotshape(getTwoDownBar(0,1), style=twoDownBarStyle, title="Two Bar Shape", location=barShapeLocation, color=getBarColor())
plotchar(getTwoDownBar(0,1), title="Two Down Bar Label", char=twoDownBarChar, location=barCharLocation, color=getBarColor())

// identify 3 candle
plotchar(getThreeBar(0,1), title="Three Bar Label", char=threeBarChar, location=barCharLocation, color=getBarColor())

// change bar color    
barcolor(getBarColor())


//plot shapes for strat combos
plotshape(is222BearishContinuation, title="is222BearishContinuation label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="222 Bearish Continuation", textcolor=stratComboBearColor, show_last=1)
plotshape(is222BullishContinuation, title="is222BullishContinuation label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="222 Bullish Continuation", textcolor=stratComboBullColor, show_last=1)
plotshape(is212BearishContinuationMeasuredMove, title="is212BearishContinuationMeasuredMove label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="212 Bearish Continuation Measured Move", textcolor=stratComboBearColor, show_last=1)
plotshape(is212BullishContinuationMeasuredMove, title="is212BullishContinuationMeasuredMove label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="212 Bullish Continuation Measured Move", textcolor=stratComboBullColor, show_last=1)
plotshape(is22BearishReversal, title="is22BearishReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="22 Bearish Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is22BullishReversal, title="is22BullishReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="22 Bullish Reversal", textcolor=stratComboBullColor, show_last=1)
plotshape(is212BearishReversal, title="is212BearishReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="212 Bearish Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is212BullishReversal, title="is212BullishReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="212 Bullish Reversal", textcolor=stratComboBullColor, show_last=1)
plotshape(is322BearishReversal, title="is322BearishReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="322 Bearish Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is322BullishReversal, title="is322BullishReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="322 Bullish Reversal", textcolor=stratComboBullColor, show_last=1)
plotshape(is32BearishReversal, title="is32BearishReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="32 Bearish Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is32BullishReversal, title="is32BullishReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="32 Bullish Reversal", textcolor=stratComboBullColor, show_last=1)
plotshape(is312BearishReversal, title="is312BearishReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="312 Bearish Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is312BullishReversal, title="is312BullishReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="312 Bullish Reversal", textcolor=stratComboBullColor, show_last=1)
plotshape(is122BearishRevStratReversal , title="is122BearishRevStratReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="122 Bearish Rev Strat Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is122BullishRevStratReversal , title="is122BullishRevStratReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="122 Bullish Rev Strat Reversal", textcolor=stratComboBullColor, show_last=1)
plotshape(is2222BearishRandyJackson , title="is2222BearishRandyJackson label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="2222 Bearish Randy Jackson", textcolor=stratComboBearColor, show_last=1)
plotshape(is2222BullishRandyJackson , title="is2222BullishRandyJackson label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="2222 Bullish Randy Jackson", textcolor=stratComboBullColor, show_last=1)
plotshape(is3BearishRevStratReversal , title="is3BearishRevStratReversal label", style=stratComboStyle, color=stratComboBearColor, location=stratComboLocation, text="3 Bearish Rev Strat Reversal", textcolor=stratComboBearColor, show_last=1)
plotshape(is3BullishRevStratReversal , title="is3BullishRevStratReversal label", style=stratComboStyle, color=stratComboBullColor, location=stratComboLocation, text="3 Bullish Rev Strat Reversal", textcolor=stratComboBullColor, show_last=1)


//plot shape for actionableSignals
plotshape(isShooter, title="isShooter Label", style=shape.flag, color=color.red, location=location.bottom, text="Shooter", textcolor=color.red, show_last=1)
plotshape(isHammer, title="isHammer Label", style=shape.flag, color=color.green, location=location.bottom, text="Hammer", textcolor=color.green, show_last=1)
plotshape(isInsideBar, title="isInsideBar Label", style=shape.flag, color=color.yellow, location=location.bottom, text="Inside Bar", textcolor=color.yellow, show_last=1)
